#!/usr/bin/python
import time
import RPi.GPIO as GPIO
GPIO.setmode(GPIO.BOARD)
GPIO.setup(32, GPIO.OUT)


def buzz(gpio, cycleDict, timeScale=1):
    print('starting buzzer')
    gpio.ChangeDutyCycle(50)
    print(len(cycleDict))
    for cycle in cycleDict:
        print(cycle)
        gpio.ChangeFrequency(cycle[0])
        time.sleep((cycle[1]*timeScale)/1000.0)
        if len(cycle) == 3:
            gpio.ChangeDutyCycle(100)
            time.sleep(((cycle[2]-cycle[1])*timeScale)/1000.0)
            gpio.ChangeDutyCycle(50)
		

print('setting up gpio')
p = GPIO.PWM(32, 50)  # channel=12 frequency=2kHz
p.start(0)

# mario song
mario = [[660,100,150],
[660,100,300],
[660,100,300],
[510,100,100],
[660,100,300],
[770,100,550],
[380,100,575],
[510,100,450],
[380,100,400],
[320,100,500],
[440,100,300],
[480,80,330],
[450,100,150],
[430,100,300],
[380,100,200],
[660,80,200],
[760,50,150],
[860,100,300],
[700,80,150],
[760,50,350],
[660,80,300],
[520,80,150],
[580,80,150],
[480,80,500],
[510,100,450],
[380,100,400],
[320,100,500],
[440,100,300],
[480,80,330],
[450,100,150],
[430,100,300],
[380,100,200],
[660,80,200],
[760,50,150],
[860,100,300],
[700,80,150],
[760,50,350],
[660,80,300],
[520,80,150],
[580,80,150],
[480,80,500],
[500,100,300],
[760,100,100],
[720,100,150],
[680,100,150],
[620,150,300],
[650,150,300],
[380,100,150],
[430,100,150],
[500,100,300],
[430,100,150],
[500,100,100],
[570,100,220],
[500,100,300],
[760,100,100],
[720,100,150],
[680,100,150],
[620,150,300],
[650,200,300],
[1020,80,300],
[1020,80,150],
[1020,80,300],
[380,100,300],
[500,100,300],
[760,100,100],
[720,100,150],
[680,100,150],
[620,150,300],
[650,150,300],
[380,100,150],
[430,100,150],
[500,100,300],
[430,100,150],
[500,100,100],
[570,100,420],
[585,100,450],
[550,100,420],
[500,100,360],
[380,100,300],
[500,100,300],
[500,100,150],
[500,100,300],
[500,100,300],
[760,100,100],
[720,100,150],
[680,100,150],
[620,150,300],
[650,150,300],
[380,100,150],
[430,100,150],
[500,100,300],
[430,100,150],
[500,100,100],
[570,100,220],
[500,100,300],
[760,100,100],
[720,100,150],
[680,100,150],
[620,150,300],
[650,200,300],
[1020,80,300],
[1020,80,150],
[1020,80,300],
[380,100,300],
[500,100,300],
[760,100,100],
[720,100,150],
[680,100,150],
[620,150,300],
[650,150,300],
[380,100,150],
[430,100,150],
[500,100,300],
[430,100,150],
[500,100,100],
[570,100,420],
[585,100,450],
[550,100,420],
[500,100,360],
[380,100,300],
[500,100,300],
[500,100,150],
[500,100,300],
[500,60,150],
[500,80,300],
[500,60,350],
[500,80,150],
[580,80,350],
[660,80,150],
[500,80,300],
[430,80,150],
[380,80,600],
[500,60,150],
[500,80,300],
[500,60,350],
[500,80,150],
[580,80,150],
[660,80,550],
[870,80,325],
[760,80,600],
[500,60,150],
[500,80,300],
[500,60,350],
[500,80,150],
[580,80,350],
[660,80,150],
[500,80,300],
[430,80,150],
[380,80,600],
[660,100,150],
[660,100,300],
[660,100,300],
[510,100,100],
[660,100,300],
[770,100,550],
[380,100,575]]

buzz(p, mario)

print('stopping gpio')
p.stop()
GPIO.cleanup()
